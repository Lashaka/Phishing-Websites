"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_ref-selector_ts"],{82368(e,t,i){var n=i(53290),r=i(69567),s=i(76006),o=i(17945),h=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var h=e.length-1;h>=0;h--)(r=e[h])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o};let a=class extends HTMLElement{connectedCallback(){window.addEventListener("resize",this.windowResized),this.refType="branch"===this.getRequiredAttr("type")?n.r.Branch:n.r.Tag;let e=this.getAttribute("current-committish");this.currentCommittish=e?atob(e):null,this.input=this.hasAttribute("initial-filter")&&this.currentCommittish||"",this.defaultBranch=atob(this.getRequiredAttr("default-branch")),this.nameWithOwner=atob(this.getRequiredAttr("name-with-owner")),this.canCreate=this.hasAttribute("can-create"),this.prefetchOnMouseover=this.hasAttribute("prefetch-on-mouseover");let t=this.getRequiredAttr("query-endpoint"),i=this.getRequiredAttr("cache-key");this.index=new n.W(this.refType,this,t,i,this.nameWithOwner),this.updateViewportSize(),this.setupFetchListeners()}disconnectedCallback(){this.resizeAnimationRequest&&cancelAnimationFrame(this.resizeAnimationRequest),window.removeEventListener("resize",this.windowResized)}updateViewportSize(){this.isMobileViewport=window.innerWidth<544,this.windowHeight=window.innerHeight}inputEntered(e){this.input=e.detail,this.render()}tabSelected(){this.index.fetchData()}renderTemplate(e,t){return new r.R(e,t,r.XK)}renderRow(e){let t=this.index.currentSearchResult[e];if(!t&&e>=this.listLength)return document.createElement("span");if(this.index.fetchFailed)return this.renderTemplate(this.fetchFailedTemplate,{index:e,refName:this.input});if(!t){let t=this.input===this.currentCommittish;return this.isCurrentVisible||(this.isCurrentVisible=t),this.renderTemplate(this.noMatchTemplate,{index:e,isCurrent:t,refName:this.input})}let i=this.input.length>0,n=t===this.currentCommittish;this.isCurrentVisible||(this.isCurrentVisible=n);let r=this.renderTemplate(this.itemTemplate,{refName:t,index:e,isFilteringClass:i?"is-filtering":"",urlEncodedRefName:this.urlEncodeRef(t),isCurrent:n,isNotDefault:t!==this.defaultBranch});if(i){let e=r.querySelector("span");e.textContent="";let i=t.split(this.input),n=i.length-1;for(let t=0;t<i.length;t++){let r=i[t];if(e.appendChild(document.createTextNode(r)),t<n){let t=document.createElement("b");t.textContent=this.input,e.appendChild(t)}}}return r}urlEncodeRef(e){return encodeURIComponent(e).replaceAll("%2F","/").replaceAll("%3A",":").replaceAll("%2B","+")}render(){if(this.currentSelectionIndex=null,!this.index.isLoading){if(!this.virtualizedList)return this.index.search(this.input),void this.setupVirtualizedList();this.listContainer.scrollTop=0,this.index.search(this.input),this.virtualizedList.setRowCount(this.listLength)}}get listHeight(){return this.isMobileViewport?.3*this.windowHeight:330}get listLength(){let e=this.index.currentSearchResult.length;return this.showCreateRow?e+1:e||1}get showCreateRow(){return!this.index.fetchFailed&&!this.index.exactMatchFound&&""!==this.input&&this.canCreate}getRequiredAttr(e,t=this){let i=t.getAttribute(e);if(!i)throw Error(`Missing attribute for ${t}: ${e}`);return i}setupFetchListeners(){let e=this.closest("details"),t=!1,i=()=>{t||(this.index.fetchData(),t=!0)};if(!e||e.open)return void i();this.prefetchOnMouseover&&e.addEventListener("mouseover",i,{once:!0}),this.addEventListener("keydown",this.keydown),this.addEventListener("change",this.updateCurrent);let n=e.querySelector("input[data-ref-filter]");n&&(n.addEventListener("input",(()=>{this.input=n.value,this.render()})),n.addEventListener("keydown",(t=>{if("ArrowDown"===t.key||"Tab"===t.key&&!t.shiftKey)t.preventDefault(),t.stopPropagation(),this.focusFirstListMember();else if("Enter"===t.key){let i=this.index.currentSearchResult.indexOf(this.input);if(-1===i){if(!this.showCreateRow)return;i=this.listLength-1}e.querySelector(`[data-index="${i}"]`).click(),t.preventDefault()}})))}focusFirstListMember(){this.virtualizedList&&(this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex))}updateCurrent(e){e.target instanceof HTMLInputElement&&e.target.checked&&e.target.value&&(this.currentCommittish=e.target.value)}keydown(e){if(null!==this.currentSelectionIndex){if("Enter"===e.key){let t=document.activeElement;if(!t)return;return t.click(),void e.preventDefault()}if("Tab"!==e.key&&"Escape"!==e.key)switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowUp":this.currentSelectionIndex--,this.currentSelectionIndex<0&&(this.currentSelectionIndex=this.listLength-1),this.focusItemAtIndex(this.currentSelectionIndex);break;case"Home":this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex);break;case"End":this.currentSelectionIndex=this.listLength-1,this.focusItemAtIndex(this.currentSelectionIndex);break;case"ArrowDown":this.currentSelectionIndex++,this.currentSelectionIndex>this.listLength-1&&(this.currentSelectionIndex=0),this.focusItemAtIndex(this.currentSelectionIndex)}}}focusItemAtIndex(e){this.virtualizedList.scrollToIndex(e,"center"),setTimeout((()=>{let t=this.listContainer.querySelector(`[data-index="${e}"]`);t&&t.focus()}),20)}setupVirtualizedList(){this.listContainer.textContent="",this.listContainer.style.maxHeight=`${this.listHeight}px`,this.virtualizedList=new o.Z(this.listContainer,{height:this.listHeight,rowCount:this.listLength,renderRow:this.renderRow.bind(this),rowHeight:e=>{let t=this.isMobileViewport?54:33;return this.showCreateRow&&e===this.listLength-1?51:t},onRowsRendered:()=>{this.hiddenCurrentElement&&(this.listContainer.removeChild(this.hiddenCurrentElement),delete this.hiddenCurrentElement),this.isCurrentVisible?this.isCurrentVisible=!1:this.hiddenCurrentItemTemplate&&(this.hiddenCurrentElement=document.createElement("div"),this.hiddenCurrentElement?.appendChild(this.renderTemplate(this.hiddenCurrentItemTemplate,{refName:this.currentCommittish})),this.listContainer.appendChild(this.hiddenCurrentElement))},initialIndex:0,overscanCount:6}),this.virtualizedList.resize.bind(this.virtualizedList)}constructor(...e){super(...e),this.isCurrentVisible=!1,this.currentSelectionIndex=null,this.handleWindowResize=()=>{if(!this.virtualizedList)return;let e=this.isMobileViewport,t=this.windowHeight;this.updateViewportSize();let i=e!==this.isMobileViewport,n=t!==this.windowHeight;if(i)return this.virtualizedList.destroy(),void this.setupVirtualizedList();this.isMobileViewport&&n&&(this.listContainer.style.maxHeight=`${this.listHeight}px`,this.virtualizedList.resize(this.listHeight))},this.windowResized=()=>{this.resizeAnimationRequest&&cancelAnimationFrame(this.resizeAnimationRequest),this.resizeAnimationRequest=requestAnimationFrame(this.handleWindowResize)}}};h([s.fA],a.prototype,"listContainer",void 0),h([s.fA],a.prototype,"itemTemplate",void 0),h([s.fA],a.prototype,"noMatchTemplate",void 0),h([s.fA],a.prototype,"fetchFailedTemplate",void 0),h([s.fA],a.prototype,"hiddenCurrentItemTemplate",void 0),a=h([s.Ih],a)},53290(e,t,i){i.d(t,{W:()=>c,r:()=>r});var n,r,s=i(86702),o=i(60958);let{getItem:h,setItem:a,removeItem:l}=(0,s.Z)("localStorage",{throwQuotaErrorsOnSet:!0});(n=r||(r={})).Branch="branch",n.Tag="tag";class c{render(){this.selector.render()}async fetchData(){try{if(!this.isLoading||this.fetchInProgress)return;if(!this.bootstrapFromLocalStorage()){this.fetchInProgress=!0,this.fetchFailed=!1;let e=await fetch(`${this.refEndpoint}?type=${this.refType}`,{headers:{Accept:"application/json"}});await this.processResponse(e)}this.isLoading=!1,this.fetchInProgress=!1,this.render()}catch(e){this.fetchInProgress=!1,this.fetchFailed=!0}}async processResponse(e){if(this.emitStats(e),!e.ok)return void(this.fetchFailed=!0);let t=e.clone(),i=await e.json();this.knownItems=i.refs,this.cacheKey=i.cacheKey,this.flushToLocalStorage(await t.text())}emitStats(e){if(e.ok)switch(e.status){case 200:(0,o.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_UNCACHED_HTTP"});break;case 304:(0,o.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_HTTP_CACHE"});break;default:(0,o.b)({incrementKey:"REF_SELECTOR_UNEXPECTED_RESPONSE"})}else(0,o.b)({incrementKey:"REF_SELECTOR_BOOT_FAILED"},!0)}search(e){if(this.searchTerm=e,""===e)return void(this.currentSearchResult=this.knownItems);let t,i=[],n=[];this.exactMatchFound=!1;for(let r of this.knownItems)if(!((t=r.indexOf(e))<0)){if(0===t){e===r?(n.unshift(r),this.exactMatchFound=!0):n.push(r);continue}i.push(r)}this.currentSearchResult=[...n,...i]}bootstrapFromLocalStorage(){let e=h(this.localStorageKey);if(!e)return!1;let t=JSON.parse(e);return t.cacheKey===this.cacheKey&&"refs"in t?(this.knownItems=t.refs,this.isLoading=!1,(0,o.b)({incrementKey:"REF_SELECTOR_BOOTED_FROM_LOCALSTORAGE"}),!0):(l(this.localStorageKey),!1)}async flushToLocalStorage(e){try{a(this.localStorageKey,e)}catch(t){if(!t.message.toLowerCase().includes("quota"))throw t;this.clearSiblingLocalStorage(),(0,o.b)({incrementKey:"REF_SELECTOR_LOCALSTORAGE_OVERFLOWED"});try{a(this.localStorageKey,e)}catch(e){e.message.toLowerCase().includes("quota")&&(0,o.b)({incrementKey:"REF_SELECTOR_LOCALSTORAGE_GAVE_UP"})}}}clearSiblingLocalStorage(){for(let e of Object.keys(localStorage))e.startsWith(c.LocalStoragePrefix)&&l(e)}get localStorageKey(){return`${c.LocalStoragePrefix}:${this.nameWithOwner}:${this.refType}`}constructor(e,t,i,n,r){this.knownItems=[],this.currentSearchResult=[],this.exactMatchFound=!1,this.searchTerm="",this.isLoading=!0,this.fetchInProgress=!1,this.fetchFailed=!1,this.refType=e,this.selector=t,this.refEndpoint=i,this.cacheKey=n,this.nameWithOwner=r}}c.LocalStoragePrefix="ref-selector"},86702(e,t,i){i.d(t,{Z:()=>o,_:()=>h});var n=i(86283),r=i(60958);let s=class{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}};function o(e,t={throwQuotaErrorsOnSet:!1},i=n.iG,o=(e=>e),h=(e=>e)){let a;try{if(!i)throw Error();a=i[e]||new s}catch{a=new s}let{throwQuotaErrorsOnSet:l}=t;function c(e){t.sendCacheStats&&(0,r.b)({incrementKey:e})}function u(e){try{if(a.removeItem(e),t.ttl){let t=`${e}:expiry`;a.removeItem(t)}}catch(e){}}return{getItem:function(e,t=(new Date).getTime()){try{let i=a.getItem(e);if(!i)return null;let n=`${e}:expiry`,r=Number(a.getItem(n));return r&&t>r?(u(e),u(n),c("SAFE_STORAGE_VALUE_EXPIRED"),null):(c("SAFE_STORAGE_VALUE_WITHIN_TTL"),o(i))}catch(e){return null}},setItem:function(e,i,n=(new Date).getTime()){try{if(a.setItem(e,h(i)),t.ttl){let i=`${e}:expiry`,r=n+t.ttl;a.setItem(i,r.toString())}}catch(e){if(l&&e.message.toLowerCase().includes("quota"))throw e}},removeItem:u,clear:a.clear,key:a.key,get length(){return a.length}}}function h(e){return o(e,{throwQuotaErrorsOnSet:!1},window,JSON.parse,JSON.stringify)}},60958(e,t,i){i.d(t,{B:()=>c,b:()=>h});var n=i(86283),r=i(4412),s=i(53729);let o=[];function h(e,t=!1){void 0===e.timestamp&&(e.timestamp=(new Date).getTime()),e.loggedIn=!!n.n4?.head?.querySelector('meta[name="user-login"]')?.content,e.staff=c(),e.bundler=s.A7,o.push(e),t?l():async function(){await r.C,null==a&&(a=window.requestIdleCallback(l))}()}let a=null;function l(){if(a=null,!o.length)return;let e=n.n4?.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(!e)return;let t=JSON.stringify({stats:o});try{navigator.sendBeacon&&navigator.sendBeacon(e,t)}catch{}o=[]}function c(){return!!n.n4?.head?.querySelector('meta[name="user-staff"]')?.content}n.n4?.addEventListener("pagehide",l),n.n4?.addEventListener("visibilitychange",l)},4412(e,t,i){i.d(t,{C:()=>s,x:()=>r});var n=i(86283);let r="interactive"===n.n4?.readyState||"complete"===n.n4?.readyState?Promise.resolve():new Promise((e=>{n.n4?.addEventListener("DOMContentLoaded",(()=>{e()}))})),s="complete"===n.n4?.readyState?Promise.resolve():new Promise((e=>{n.iG?.addEventListener("load",e)}))},53729(e,t,i){i.d(t,{A7:()=>a,ko:()=>h,q1:()=>o});var n=i(15205),r=i(86283);let s=(0,n.Z)((function(){return r.n4?.head?.querySelector('meta[name="runtime-environment"]')?.content||""})),o=(0,n.Z)((function(){return"true"===r.n4?.head?.querySelector('meta[name="is-private-instance"]')?.content})),h=(0,n.Z)((function(){return"enterprise"===s()})),a="webpack"},86283(e,t,i){i.d(t,{Qg:()=>n.Qg,iG:()=>r.iG,jX:()=>r.jX,n4:()=>r.n4,yF:()=>n.yF});var n=i(35647),r=i(73614)},73614(e,t,i){i.d(t,{iG:()=>r,jX:()=>s,n4:()=>n});let n="undefined"==typeof document?void 0:document,r="undefined"==typeof window?void 0:window,s="undefined"==typeof location?{pathname:"",origin:"",search:""}:location},35647(e,t,i){i.d(t,{Qg:()=>s,yF:()=>o});var n=i(73614);let r=void 0===n.n4,s=!r;function o(){return!!r||Boolean(n.n4.querySelector('react-app[data-ssr="true"]'))}}}]);